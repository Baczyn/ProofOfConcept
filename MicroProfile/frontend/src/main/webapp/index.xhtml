<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://java.sun.com/jsf/html"
>

<body>
<f:event listener="#{reviewBean.endConversation()}"
         type="preRenderView"></f:event>
<h1>Welcome to The Band webpage</h1>
<p>In that page you can check our past and feature events. You can book tickets to upcoming gigs and share your opinion by commenting/liking events.</p>
<h:panelGroup rendered="#{empty user}" layout="block">
    <p><a href="login.jsf">Log in</a> if you already have an account.</p>
    <p><a href="register.jsf">Register</a> to try out the application.</p>
</h:panelGroup>
<h:panelGroup rendered="#{not empty user}" layout="block">
    <p> Hello #{user} ! </p>
    <FORM METHOD="POST" ACTION="ibm_security_logout" NAME="logout">
        <input type="submit" name="logout" value="Log Out"/>
        <input type="HIDDEN" name="logoutExitPage" value="/index.jsf"/>
    </FORM>
</h:panelGroup>
<div>
    <h2>Events</h2>
    <h:form>
        <h:outputLink value="eventForm.jsf" rendered="#{role eq 'admin'}">Add Event</h:outputLink>
    </h:form>
    <h:form>
        <h:outputLink value="orderDetails.jsf" rendered="#{not empty role}">Your Reservations</h:outputLink>
    </h:form>
    <h:dataTable value="#{eventBean.getAll()}" var="event">
        <h:column>
            <f:facet name="header">Title</f:facet>
            #{event.title}
        </h:column>
        <h:column>
            <f:facet name="header">Date</f:facet>
            #{event.date}
        </h:column>
        <h:column>
            <f:facet name="header">Location</f:facet>
            #{event.location.country},
            #{event.location.city},
            #{event.location.streetName}
            #{event.location.streetNumber},
            #{event.location.facilityName}
        </h:column>
        <h:column>
            <h:form>
                <p><h:commandButton value="View" type="submit"
                                    action="#{eventBean.doView(event.id)}">
                </h:commandButton>
                </p>
            </h:form>
        </h:column>
        <h:column rendered="#{role eq 'admin'}">
                <h:outputLink value="eventForm.jsf?id=#{event.id}">Edit</h:outputLink>
        </h:column>
        <h:column>
            <h:form>
                <p>
                    <h:commandButton rendered="#{role eq 'admin'}" value="Delete" type="submit"
                                     action="#{eventBean.doRemoveEvent(event.id)}">
                    </h:commandButton>
                </p>
            </h:form>
        </h:column>
    </h:dataTable>
</div>
</body>
</html>
