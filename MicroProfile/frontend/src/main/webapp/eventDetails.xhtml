<!DOCTYPE html>
<html xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns="http://www.w3.org/1999/xhtml"
>
<h:head>
    <title> Event Page </title>
</h:head>
<h:body>
<h1>Event Details</h1>
<h:dataTable value="#{eventBean.doGetById(param['id'])}" var="event">
    <h:column>
        <f:facet name="header">Title</f:facet>
        #{event.title}
    </h:column>
    <h:column>
        <f:facet name="header">Date</f:facet>
        #{event.date}
    </h:column>
    <h:column>
        <f:facet name="header">Description</f:facet>
        #{event.description}
    </h:column>
    <h:column>
        <f:facet name="header">Location</f:facet>
        #{event.location.country},
        #{event.location.city},
        #{event.location.streetName}
        #{event.location.streetNumber},
        #{event.location.facilityName}
    </h:column>
    <h:column rendered="#{role eq 'admin'}">
        <f:facet name="header">Available Tickets</f:facet>
        40
    </h:column>
    <h:column rendered="#{role eq 'admin'}">
        <h:form>
            <h:commandButton value="Edit" onclick="location.href = 'eventForm.jsf';" type="submit"
                             action="#{eventBean.doEditEvent(events.id)}">
            </h:commandButton>
        </h:form>
    </h:column>
</h:dataTable>

<h:form rendered="#{not empty role}">
    <p>

        <h:commandButton value="Comment" type="submit"
                         action="#{applicationBean.doView(events.id)}">
        </h:commandButton>
    </p>
</h:form>
<h:form rendered="#{not empty role}">
    <p>
        Number Of Tickets
        <h:inputText id="noTickets" value="1" required="true"/>
    </p>
    <p>
        <h:commandButton value="Book" type="submit"
                         action="#{applicationBean.doView(events.id)}">
        </h:commandButton>
    </p>
</h:form>
<h:form rendered="#{not empty role}">
    <p>
        <h:commandButton value="Like it" type="submit"
                         action="#{applicationBean.doView(events.id)}">
        </h:commandButton>
    </p>
</h:form>

<h1>Comments</h1>


<script type="text/javascript">
    // Force safari to refresh the page
    // if a cached copy was loaded
    // from the browser back-forward cache.
    window.onpageshow = function(e) {
      if (e.persisted) {
        window.location.reload();
      }
    }
</script>
</h:body>
</html>
